data_source:
  name: customer_dn
  description: Customer basic information, as well as some derived facts based on a customer's orders
  owners:
    - dat@infinitelambda.com

  identifiers:
    - name: customer_dn
      type: primary
      expr: customer_id

  measures:
    - name: new_customers_dn
      description: New paid customers
      expr: customer_id
      agg: COUNT_DISTINCT
    - name: total_orders_dn
      description: Customer total number of orders
      expr: number_of_orders
      agg: SUM
    - name: total_lifetime_value_dn
      description: Customer total life time value
      expr: customer_lifetime_value
      agg: SUM

  dimensions:
    - name: country
      description: The country where the customer is located.
      type: categorical
    - name: first_order
      description: The date where order has been firsly placed
      type: time
      type_params:
        is_primary: true
        time_granularity: day

  mutability:
    type: full_mutation

  sql_table: DBT_METRIC_DEMO.DAT_N_MART.CUSTOMERS